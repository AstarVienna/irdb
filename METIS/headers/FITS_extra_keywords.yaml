- ext_type: PrimaryHDU
  keywords:
    MJD-OBS: "!OBS.mjdobs"
    RA: "!OBS.ra"
    DEC: "!OBS.dec"
    INSTRUME: "METIS"
    # Airmass is not part of the atmosphere itself but rather of the
    # observation and is usually a top level keyword in the ESO world.
    AIRMASS: "!OBS.airmass"
    HIERARCH:
      ESO:
        # Keywords in the ESO hierarchy should also appear in the raw data.
        # However, many of these have not yet been decided on.
        DPR:
          CATG: "!OBS.catg"
          TYPE: "!OBS.type"
          TECH: "!OBS.tech"
        DET:
          DIT: "!OBS.dit"
          NDIT: "!OBS.ndit"
          READOUT: "CDS"
          NAME: ""
          TEMPERAT: "!DET.temperature"
          # TODO: Include a ReferencePixelBorder effect?
          #REF:
          #  ALL: "#border_reference_pixels.all"
        INS:
          # TODO: Something sensible for INS.MODE
          MODE: "TODO"
          NAME: "METIS"
          FILT:
            NAME: "!OBS.filter_name"
          NDFILT:
            NAME: "!OBS.nd_filter_name"
          # TODO: The OPTI keywords
          #OPTI6:
          #  NAME: "open"
          DROT: 0
          # TODO: What should be the READMODE?
          READMODE: "TODO"
          PLATE_SC: "!INST.plate_scale"
        TPL:
          START: "!OBS.tplstart"
          EXPNO: "!OBS.tplexpno"
        OBS:
          TPLNO: "!OBS.tplno"
          INSTRUME: "METIS"
          NAME: "!OBS.obsname"
          RA: "!OBS.ra"
          DEC: "!OBS.dec"
        ATMO:
          LOCATION: "!ATMO.location"
          ALTITUDE: "!ATMO.altitude"
          LONGITUD: "!ATMO.longitude"
          LATITUDE: "!ATMO.latitude"
          TEMPERAT: "!ATMO.temperature"
          HUMIDITY: "!ATMO.humidity"
          PRESSURE: "!ATMO.pressure"
          PWV: "!ATMO.pwv"
      WISE:
        # Extra keywords to be used by MetisWISE.
        # These are specific to ScopeSIM.
        DET:
          IMAGE_PL: "!DET.image_plane_id"
          TEMPERAT: "!DET.temperature"
          DAR:
            # TODO: directly ask the dark_current effect for its value, like
            #VALUE: "#dark_current.value"
            # However, that currently does not work because that resolves to
            # !DET.dark_current which is not subsequently resolved.
            VALUE: "!DET.dark_current"
          SHO:
            STATE: "#shot_noise.include"
          QEC:
            FILENAME: "#quantum_efficiency.filename"
          LIN:
            FILENAME: "#detector_linearity.filename"
        TEL:
          NAME: "ELT"
          TELESCOP: "ELT"
          TER:
            FILENAME: "!TEL.ter_curve.filename"
          REF:
            FILENAME: "#telescope_reflection.filename"
        OCS:
          PXSCALE: "!INST.pixel_scale"
- ext_type: ImageHDU
  keywords:
    INHERIT: "T"
    # Will resolve to e.g. DET1.DATA, DET2.DATA etc., as required by ESO.
    EXTNAME: "DETÂ§.DATA"
